<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>EAV - Cutting Optimizer</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
            touch-action: manipulation;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: none;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #ffffff;
            color: #1a1a1a;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            max-height: 100vh;
            overflow: hidden;
        }
        
        /* Main container - FIXED HEIGHT/NO SCROLL */
        .home-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: clamp(0.5rem, 2vmin, 1.5rem);
            width: 100%;
            height: 100%;
            max-height: 100vh;
            overflow: hidden;
            position: relative;
            gap: clamp(0.5rem, 1vmin, 1rem); /* REDUCED GAP */
        }
        
        /* Center wrapper - IMPROVED LAYOUT */
        .center-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            max-height: calc(100vh - 70px);
            flex: 1;
            overflow: hidden;
            gap: clamp(0.25rem, 1vmin, 0.75rem); /* ADDED GAP BETWEEN TITLE AND CARDS */
        }
        
        /* Header section - ADJUSTED MARGINS */
        .header-section {
            text-align: center;
            margin-bottom: 0; /* REMOVED BOTTOM MARGIN */
            width: 100%;
            max-width: min(90vw, 800px);
            padding: 0 clamp(0.5rem, 2vmin, 1rem);
            flex-shrink: 0;
        }
        
        .main-title {
            font-size: clamp(1.75rem, 5vw, 2.5rem);
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 0.15rem; /* REDUCED MARGIN */
            line-height: 1.2;
            word-wrap: break-word;
            hyphens: auto;
        }
        
        .tagline {
            font-size: clamp(0.875rem, 3vw, 1.125rem);
            color: #666;
            font-weight: 400;
            line-height: 1.4;
            margin-bottom: 0.25rem; /* ADDED SMALL BOTTOM MARGIN */
        }
        
        /* Options grid - ALWAYS 3 COLUMNS */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: clamp(0.75rem, 2vmin, 1.5rem);
            width: 100%;
            max-width: min(95vw, 900px);
            height: auto;
            min-height: min(25vh, 250px); /* REDUCED MIN-HEIGHT */
            padding: clamp(0.25rem, 1vmin, 0.75rem); /* REDUCED PADDING */
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            flex: 1;
            overflow: hidden;
            grid-auto-flow: dense;
        }
        
        /* Circular option cards - PERFECT CIRCLE FIX */
        .option-circle-wrapper {
            position: relative;
            width: 100%;
            padding-bottom: 100%; /* This creates a square container */
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        .option-circle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%; /* PERFECT CIRCLE */
            background-color: #2c3e50;
            border: 2px solid #1a252f;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 15%;
            text-align: center;
            overflow: hidden;
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
            box-sizing: border-box;
            aspect-ratio: 1/1; /* Ensures perfect circle */
        }
        
        .option-circle:active {
            transform: scale(0.95);
            background-color: #1a252f;
        }
        
        /* Icon */
        .circle-icon {
            width: auto;
            height: auto;
            max-width: 60%;
            max-height: 60%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            font-size: clamp(1.5rem, 6vmin, 2.5rem);
            margin-bottom: 8%;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }
        
        /* Title */
        .circle-title {
            font-size: clamp(0.75rem, 2.5vmin, 1rem);
            font-weight: 400;
            color: #ffffff;
            margin: 0;
            line-height: 1.3;
            word-wrap: break-word;
            hyphens: auto;
            width: 90%;
            text-align: center;
        }
        
        /* Footer */
        .home-footer {
            padding: clamp(0.5rem, 2vmin, 1rem);
            text-align: center;
            color: #666;
            font-size: clamp(0.7rem, 2vmin, 0.875rem);
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            flex-shrink: 0;
            border-top: 1px solid #f0f0f0;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .home-container {
            animation: fadeIn 0.4s ease-out;
        }
        
        /* SPECIAL ADJUSTMENTS FOR VERY SMALL SCREENS */
        @media (max-width: 480px) {
            .home-container {
                gap: 0.25rem; /* FURTHER REDUCED GAP ON MOBILE */
            }
            
            .center-wrapper {
                gap: 0.25rem; /* FURTHER REDUCED GAP ON MOBILE */
            }
            
            .options-grid {
                gap: clamp(0.5rem, 1.5vmin, 1rem);
                padding: 0.15rem; /* FURTHER REDUCED PADDING */
                min-height: min(22vh, 220px); /* FURTHER REDUCED ON MOBILE */
            }
            
            .option-circle {
                padding: 12%;
            }
            
            .circle-icon {
                margin-bottom: 6%;
                font-size: clamp(1.25rem, 5vmin, 2rem);
            }
            
            .circle-title {
                font-size: clamp(0.65rem, 2vmin, 0.85rem);
            }
        }
        
        /* For extremely narrow screens (like iPhone SE) */
        @media (max-width: 360px) {
            .home-container {
                padding: 0.25rem;
                gap: 0.15rem;
            }
            
            .center-wrapper {
                gap: 0.15rem;
            }
            
            .options-grid {
                gap: 0.4rem;
                padding: 0.1rem;
                min-height: min(20vh, 200px);
            }
            
            .main-title {
                font-size: 1.5rem;
                margin-bottom: 0.1rem;
            }
            
            .tagline {
                font-size: 0.875rem;
                margin-bottom: 0.15rem;
            }
            
            .option-circle {
                padding: 10%;
            }
            
            .circle-icon {
                margin-bottom: 5%;
                font-size: 1.25rem;
            }
            
            .circle-title {
                font-size: 0.7rem;
            }
        }
        
        /* Landscape mode adjustments */
        @media (orientation: landscape) and (max-height: 500px) {
            .home-container {
                padding: 0.15rem;
                gap: 0.15rem;
            }
            
            .center-wrapper {
                flex-direction: row;
                gap: clamp(0.5rem, 2vw, 1rem);
            }
            
            .header-section {
                margin-bottom: 0;
                margin-right: clamp(0.5rem, 2vw, 1rem);
                max-width: 40%;
                text-align: left;
            }
            
            .options-grid {
                grid-template-columns: repeat(3, 1fr);
                max-width: 60%;
                gap: clamp(0.5rem, 1.5vw, 1rem);
                padding: 0.15rem;
                min-height: min(25vh, 200px);
            }
            
            .option-circle-wrapper {
                padding-bottom: 90%; /* Slightly smaller in landscape */
            }
            
            .main-title {
                font-size: clamp(1.25rem, 4vw, 1.75rem);
            }
            
            .tagline {
                font-size: clamp(0.75rem, 2vw, 0.875rem);
            }
        }
        
        /* Large screens */
        @media (min-width: 1200px) and (min-height: 700px) {
            .center-wrapper {
                gap: 0.5rem;
            }
            
            .options-grid {
                min-height: min(28vh, 280px);
            }
            
            .option-circle-wrapper {
                max-width: 250px;
                margin: 0 auto;
            }
            
            .circle-icon {
                font-size: 2.5rem;
            }
            
            .circle-title {
                font-size: 1.1rem;
            }
        }
        
        /* Hide scrollbars */
        body::-webkit-scrollbar {
            display: none;
        }
        
        body {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Color variations for different options */
        .option-circle:nth-child(1) {
            background-color: #2c3e50;
            border-color: #1a252f;
        }
        
        .option-circle:nth-child(1):active {
            background-color: #1a252f;
        }
        
        .option-circle:nth-child(2) {
            background-color: #34495e;
            border-color: #2c3e50;
        }
        
        .option-circle:nth-child(2):active {
            background-color: #2c3e50;
        }
        
        .option-circle:nth-child(3) {
            background-color: #2c3e50;
            border-color: #1a252f;
        }
        
        .option-circle:nth-child(3):active {
            background-color: #1a252f;
        }
        
        /* Loading state - FIXED: Reset on page load */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
        
        /* Safe area support for notched phones */
        @supports (padding: max(0px)) {
            .home-container {
                padding-left: max(0.5rem, env(safe-area-inset-left));
                padding-right: max(0.5rem, env(safe-area-inset-right));
                padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
            }
            
            .home-footer {
                padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
            }
        }
        
        /* Prevent text size adjustment on orientation change */
        html {
            -webkit-text-size-adjust: 100%;
            text-size-adjust: 100%;
        }
        
        /* Hover effect for desktop */
        @media (hover: hover) and (pointer: fine) {
            .option-circle:hover {
                transform: scale(1.05);
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
                border-color: #34495e;
                background-color: #34495e;
            }
        }
    </style>
</head>
<body>
    <div class="home-container">
        <div class="center-wrapper">
            <div class="header-section">
                <h1 class="main-title">EAV - Cutting Optimizer</h1>
                <p class="tagline">First has to be Sketched</p>
            </div>
            
            <div class="options-grid">
                <!-- 1D Optimizer Circle -->
                <div class="option-circle-wrapper">
                    <div class="option-circle" onclick="navigateTo('1d-optimizer.html')">
                        <div class="circle-icon">
                            <i class="fas fa-minus"></i>
                        </div>
                        <h3 class="circle-title">1D Optimizer</h3>
                    </div>
                </div>
                
                <!-- 2D Optimizer Circle -->
                <div class="option-circle-wrapper">
                    <div class="option-circle" onclick="navigateTo('2d-optimizer.html')">
                        <div class="circle-icon">
                            <i class="far fa-square"></i>
                        </div>
                        <h3 class="circle-title">2D Optimizer</h3>
                    </div>
                </div>
                
                <!-- Custom Optimizer Circle -->
                <div class="option-circle-wrapper">
                    <div class="option-circle" onclick="navigateTo('custom-optimizer.html')">
                        <div class="circle-icon">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <h3 class="circle-title">Custom Optimizer</h3>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="home-footer">
            <p>Engineered by Eghy Al Vandi</p>
        </div>
    </div>
    
    <script>
        // Reset state function to fix issue #2
        function resetPageState() {
            // Remove loading class from all circles
            const circles = document.querySelectorAll('.option-circle');
            circles.forEach(circle => {
                circle.classList.remove('loading');
                circle.style.transform = '';
                circle.style.pointerEvents = 'auto';
            });
            
            // Reset any inline styles
            document.body.style.overflow = 'hidden';
            document.documentElement.style.overflow = 'hidden';
            
            // Reset scroll position
            window.scrollTo(0, 0);
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
            
            console.log('Page state reset - ready for interaction');
        }
        
        // Navigation function with loading indicator and state reset
        function navigateTo(url) {
            // Remove any existing loading states first
            resetPageState();
            
            // Add loading effect
            const circles = document.querySelectorAll('.option-circle');
            circles.forEach(circle => {
                circle.classList.add('loading');
                circle.style.pointerEvents = 'none';
            });
            
            // Navigate after short delay for feedback
            setTimeout(() => {
                // Save navigation state to localStorage to detect back button
                localStorage.setItem('returningFromOptimizer', 'true');
                window.location.href = url;
            }, 150);
        }
        
        // Prevent all scrolling and zooming
        document.addEventListener('touchmove', function(e) {
            if (e.target.closest('.option-circle')) {
                return; // Allow touch on circles
            }
            e.preventDefault();
        }, { passive: false });
        
        document.addEventListener('wheel', function(e) {
            if (e.ctrlKey) return; // Allow zoom with ctrl
            e.preventDefault();
        }, { passive: false });
        
        // Prevent keyboard scrolling
        document.addEventListener('keydown', function(e) {
            const keyCodes = [32, 33, 34, 35, 36, 37, 38, 39, 40];
            if (keyCodes.includes(e.keyCode)) {
                e.preventDefault();
            }
        }, false);
        
        // Add click animation with reset
        document.querySelectorAll('.option-circle').forEach(circle => {
            circle.addEventListener('click', function(e) {
                // Prevent multiple clicks
                if (this.classList.contains('loading')) {
                    e.preventDefault();
                    return;
                }
                
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    if (!this.classList.contains('loading')) {
                        this.style.transform = '';
                    }
                }, 200);
            });
        });
        
        // Force layout to fit screen without scroll
        function forceFitLayout() {
            const container = document.querySelector('.home-container');
            const body = document.body;
            const html = document.documentElement;
            
            // Reset any inline styles that might cause issues
            container.style.height = '100vh';
            container.style.width = '100vw';
            body.style.overflow = 'hidden';
            html.style.overflow = 'hidden';
            
            // Ensure viewport is properly set
            const viewport = document.querySelector('meta[name="viewport"]');
            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover');
            
            // Force perfect circles
            const circleWrappers = document.querySelectorAll('.option-circle-wrapper');
            circleWrappers.forEach(wrapper => {
                const width = wrapper.offsetWidth;
                wrapper.style.height = width + 'px';
                wrapper.style.paddingBottom = '0';
            });
        }
        
        // Additional fix for circle shapes
        function fixCircleShapes() {
            const circles = document.querySelectorAll('.option-circle');
            circles.forEach(circle => {
                const width = circle.offsetWidth;
                const height = circle.offsetHeight;
                
                // If not perfect circle, make it square
                if (Math.abs(width - height) > 1) {
                    const size = Math.min(width, height);
                    circle.style.width = size + 'px';
                    circle.style.height = size + 'px';
                    circle.style.left = '50%';
                    circle.style.top = '50%';
                    circle.style.transform = 'translate(-50%, -50%)';
                }
            });
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Home page initialized - Responsive layout active');
            
            // Check if returning from optimizer page
            if (localStorage.getItem('returningFromOptimizer') === 'true') {
                console.log('Returning from optimizer - resetting state');
                setTimeout(resetPageState, 100);
                localStorage.removeItem('returningFromOptimizer');
            }
            
            forceFitLayout();
            
            // Additional safety: disable double-tap zoom on iOS
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
            
            // Run circle fix after initial render
            setTimeout(fixCircleShapes, 100);
        });
        
        // Call on resize
        window.addEventListener('resize', function() {
            forceFitLayout();
            fixCircleShapes();
        });
        
        window.addEventListener('orientationchange', function() {
            setTimeout(function() {
                forceFitLayout();
                fixCircleShapes();
                resetPageState();
            }, 100);
        });
        
        // Prevent any form of zooming
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        });
        
        // Extra protection against unwanted scrolling
        window.scrollTo(0, 0);
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
        
        // Lock body scroll
        document.body.style.overflow = 'hidden';
        document.documentElement.style.overflow = 'hidden';
    </script>
</body>
</html>
