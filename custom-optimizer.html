<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Custom Optimizer - EAV Cutting Optimizer</title><link rel="stylesheet" href="styles.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script><script src="optimization-algorithms.js" defer></script><script src="pdf-export.js" defer></script><script src="script.js" defer></script><style>body{background-color:#f9fafb;font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;min-height:100vh;display:flex;flex-direction:column;color:#1a1a1a} .container{max-width:1200px;margin:0 auto;padding:0 1rem;width:100%} .header{background-color:#ffffff;border-bottom:1px solid #e5e7eb;padding:1rem 0;position:sticky;top:0;z-index:50;height:70px;display:flex;align-items:center} @media (max-width:768px){.header{padding:0.75rem 0;height:60px} } .header-content{display:flex;justify-content:space-between;align-items:center;height:100%;width:100%} .page-title{display:flex;align-items:center;gap:0.75rem} .page-icon{width:40px;height:40px;background-color:#2c3e50;border-radius:8px;display:flex;align-items:center;justify-content:center;color:white;font-size:1.125rem;flex-shrink:0} @media (max-width:768px){.page-icon{width:36px;height:36px;font-size:1rem} } .title-text{display:flex;flex-direction:column;gap:0.125rem} @media (max-width:768px){.title-text{gap:0} } .title-text h1{font-size:1.375rem;font-weight:600;color:#1a1a1a;margin:0;line-height:1.2} .title-text p{font-size:0.8125rem;color:#6b7280;margin:0;line-height:1.2} .back-btn{display:flex;align-items:center;gap:0.5rem;padding:0.625rem 1rem;background-color:#ffffff;border:1px solid #d1d5db;border-radius:6px;color:#4b5563;font-weight:500;text-decoration:none;transition:all 0.15s ease;min-width:auto;height:40px} .back-btn-text{display:inline;font-size:0.875rem} @media (max-width:768px){.back-btn{padding:0.5rem;width:44px;height:44px;justify-content:center} .back-btn-text{display:none} .back-btn i{margin:0;font-size:1.25rem} } .back-btn:hover{background-color:#2c3e50;border-color:#2c3e50;color:white} .main-content{padding:1.5rem 0;min-height:calc(100vh - 70px);display:flex;align-items:stretch} @media (max-width:768px){.main-content{padding:1rem 0;min-height:calc(100vh - 60px)} } .content-grid{display:grid;grid-template-columns:1fr 1.5fr;gap:1.5rem;height:100%;align-items:start} @media (max-width:1024px){.content-grid{grid-template-columns:1fr;gap:1rem} } .panel{background-color:#ffffff;border-radius:10px;border:1px solid #e5e7eb;overflow:hidden;height:100%;display:flex;flex-direction:column} .panel-header{padding:1.25rem 1.5rem;border-bottom:1px solid #e5e7eb;background-color:#f9fafb;flex-shrink:0;display:flex;justify-content:space-between;align-items:center} @media (max-width:768px){.panel-header{padding:1rem;flex-direction:column;align-items:flex-start;gap:0.75rem} } .panel-title{font-size:1.25rem;font-weight:600;color:#1a1a1a;margin:0;display:flex;align-items:center;gap:0.75rem} @media (max-width:768px){.panel-title{font-size:1.125rem} } .export-pdf-container{display:flex;align-items:center;gap:0.5rem} @media (max-width:768px){.export-pdf-container{align-self:flex-end} } .panel-content{padding:1.5rem;flex:1;overflow-y:auto} @media (max-width:768px){.panel-content{padding:1.25rem} } .form-group{margin-bottom:1.5rem} .form-label{display:flex;align-items:center;gap:0.5rem;font-size:0.9375rem;font-weight:500;color:#374151;margin-bottom:0.5rem} @media (max-width:768px){.form-label{font-size:0.875rem;color:#374151} } .mode-selector{display:flex;flex-direction:column;gap:1rem;margin-bottom:2rem} .mode-option{display:flex;align-items:center;gap:1rem;padding:1rem;background-color:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;cursor:pointer;transition:all 0.15s ease} .mode-option:hover{border-color:#9ca3af;background-color:#f3f4f6} .mode-option.active{border-color:#3b82f6;background-color:#eff6ff;box-shadow:0 0 0 1px #3b82f6} .mode-icon{width:40px;height:40px;background-color:#2c3e50;border-radius:8px;display:flex;align-items:center;justify-content:center;color:white;font-size:1.125rem;flex-shrink:0} .mode-info{flex:1} .mode-name{font-weight:600;color:#1a1a1a;margin-bottom:0.25rem} .mode-description{font-size:0.8125rem;color:#6b7280} .ff-ca01-params{background-color:#f9fafb;border-radius:8px;padding:1.5rem;margin-bottom:1.5rem} .ff-ca01-title{font-size:1rem;font-weight:600;color:#1a1a1a;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem} .ff-ca01-image-container{text-align:center;margin-bottom:1.5rem;padding:1rem;background-color:#ffffff;border-radius:8px;border:1px solid #e5e7eb;box-shadow:0 2px 4px rgba(0, 0, 0, 0.05)} .ff-ca01-image{max-width:100%;max-height:200px;border-radius:6px;border:1px solid #d1d5db} .ff-ca01-image-caption{font-size:0.8125rem;color:#6b7280;margin-top:0.5rem;font-style:italic} .ff-ca01-table{margin-top:1.5rem;overflow-x:auto} .ff-ca01-table table{min-width:300px;border-radius:8px;overflow:hidden;border:1px solid #e5e7eb;width:100%;border-collapse:collapse} .ff-ca01-table th{font-weight:600;font-size:0.875rem;padding:0.75rem;border:1px solid #e5e7eb;text-align:center;color:#1a1a1a} .ff-ca01-table td{padding:0.75rem;border:1px solid #e5e7eb} .ff-ca01-table td input{padding:0.5rem 0.75rem;font-size:0.875rem;width:100%;border:1px solid #d1d5db;border-radius:6px;box-sizing:border-box;color:#374151} .material-length-notice{background-color:#eff6ff;border:1px solid #93c5fd;border-radius:8px;padding:1rem;margin-bottom:1.5rem;font-size:0.875rem;color:#1e40af} .material-length-notice strong{font-weight:600} .action-buttons{display:flex;gap:1rem;margin-top:2rem} .btn-optimize{flex:1;padding:0.875rem;background-color:#2c3e50;color:white;border:none;border-radius:8px;font-weight:500;font-size:0.9375rem;cursor:pointer;transition:background-color 0.15s ease;display:flex;align-items:center;justify-content:center;gap:0.75rem;height:48px} .btn-optimize:hover{background-color:#34495e} .results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem} .stats-grid{display:grid;grid-template-columns:repeat(4, 1fr);gap:1rem;margin-bottom:1.5rem} @media (max-width:768px){.stats-grid{grid-template-columns:repeat(2, 1fr);gap:0.75rem} } .stat-card{background-color:#f9fafb;border-radius:8px;padding:1.25rem;text-align:center;border:1px solid #e5e7eb} @media (max-width:768px){.stat-card{padding:1rem} } .stat-value{font-size:1.375rem;font-weight:600;color:#1a1a1a;margin-bottom:0.25rem} @media (max-width:768px){.stat-value{font-size:1.125rem;color:#1a1a1a} } .stat-label{font-size:0.8125rem;color:#4b5563;text-transform:uppercase;letter-spacing:0.5px} @media (max-width:768px){.stat-label{color:#4b5563;font-size:0.75rem} } .empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem 1.5rem;text-align:center;background-color:#f9fafb;border:2px dashed #d1d5db;border-radius:8px;height:100%;min-height:400px} .empty-icon{font-size:3.5rem;color:#d1d5db;margin-bottom:1.5rem} .bar-details{background-color:#f9fafb;border-radius:8px;padding:1.5rem;margin-top:1rem;position:relative} .bar-info{display:flex;justify-content:space-between;margin-bottom:1rem;font-size:0.9375rem;flex-wrap:wrap;gap:0.5rem;color:#374151} @media (max-width:768px){.bar-info{font-size:0.875rem;color:#374151} } .bar-visualization-container{width:100%;overflow-x:auto;padding-bottom:10px;margin-bottom:1rem;-webkit-overflow-scrolling:touch} .bar-visualization{height:60px;background-color:#f3f4f6;border-radius:0.5rem;overflow:hidden;display:flex;border:1px solid #e5e7eb;min-width:500px;position:relative} @media (max-width:768px){.bar-visualization{min-width:600px;height:55px} } .bar-segment{height:100%;display:flex;align-items:center;justify-content:center;color:white;font-size:0.75rem;font-weight:500;border:1px solid rgba(255, 255, 255, 0.8);box-shadow:0 0 0 0.5px rgba(0, 0, 0, 0.3);box-sizing:border-box} .segment-content{display:flex;flex-direction:column;align-items:center;gap:2px;padding:2px;text-align:center} .segment-id{font-weight:700;text-shadow:0 1px 2px rgba(0, 0, 0, 0.5)} .segment-length{font-size:0.65rem;opacity:0.9;text-shadow:0 1px 1px rgba(0, 0, 0, 0.5)} .segment-waste{color:#666;font-style:italic;font-size:0.7rem} .bar-total{text-align:center;font-size:0.75rem;color:#666;margin-top:0.5rem} .bar-items-list{background-color:#ffffff;border-radius:8px;border:1px solid #e5e7eb;padding:1.25rem;margin-top:1rem;max-height:200px;overflow-y:auto} .bar-item-row{display:flex;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid #f3f4f6;align-items:center;color:#374151} .bar-item-row:last-child{border-bottom:none} .item-color-indicator{width:14px;height:14px;border-radius:3px;display:inline-block;margin-right:0.75rem;flex-shrink:0;border:1px solid rgba(0, 0, 0, 0.1)} .nav-controls{display:flex;align-items:center;gap:0.75rem} .nav-button{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background-color:#ffffff;border:1px solid #d1d5db;border-radius:6px;color:#4b5563;cursor:pointer;transition:all 0.15s ease;flex-shrink:0} .nav-button:hover{background-color:#f9fafb;border-color:#9ca3af} .nav-button:disabled{opacity:0.5;cursor:not-allowed} .scroll-indicator{text-align:center;font-size:0.8125rem;color:#6b7280;margin-top:0.75rem;display:none} @media (max-width:768px){.scroll-indicator{display:block} } .footer{text-align:center;padding:1.5rem 0;color:#6b7280;font-size:0.875rem;border-top:1px solid #e5e7eb;margin-top:auto;width:100%;background-color:#ffffff} input, select{padding:0.625rem 0.875rem;border-radius:6px;border:1px solid #d1d5db;width:100%;box-sizing:border-box;font-family:inherit;font-size:0.875rem;color:#374151;background-color:#ffffff} input:focus, select:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px rgba(59, 130, 246, 0.1)} #errorCustom{margin-top:1rem;padding:1rem;background-color:#fee2e2;border:1px solid #fca5a5;border-radius:6px;color:#dc2626} .btn{display:inline-flex;align-items:center;justify-content:center;padding:0.5rem 1rem;font-size:0.875rem;font-weight:500;border-radius:0.375rem;border:1px solid transparent;cursor:pointer;transition:all 0.15s ease;text-decoration:none} .btn-secondary{background-color:#6b7280;color:white;border-color:#6b7280} .btn-secondary:hover{background-color:#4b5563;border-color:#4b5563} .spinner{display:inline-block;width:1rem;height:1rem;border:2px solid rgba(0, 0, 0, 0.1);border-radius:50%;border-top-color:#2c3e50;animation:spin 1s ease-in-out infinite} .spinner-dark{border-top-color:#ffffff} @keyframes spin{to{transform:rotate(360deg)} } .bg-blue-50{background-color:#eff6ff} .text-blue-700{color:#1d4ed8} .bg-green-50{background-color:#f0fdf4} .text-green-700{color:#15803d} .bg-gray-50{background-color:#f9fafb} .font-medium{font-weight:500} .mt-4{margin-top:1rem} @media (max-width:768px){body{color:#1a1a1a} .panel-title, .form-label, .ff-ca01-title, .bar-info, .stat-value, .stat-label, .bar-item-row, .mode-name, .ff-ca01-table th{color:#1a1a1a !important} .btn-optimize, .btn-secondary{font-weight:600} input::placeholder, select::placeholder{color:#6b7280} #errorCustom{color:#dc2626;font-weight:500} .mode-description{color:#6b7280} .ff-ca01-table table{min-width:250px} .ff-ca01-table th, .ff-ca01-table td{padding:0.5rem;font-size:0.8125rem} } @media (max-width:480px){.panel-content{padding:1rem} .ff-ca01-params{padding:1rem} .stat-card{padding:0.875rem} .stat-value{font-size:1rem} .stat-label{font-size:0.7rem} .bar-details{padding:1rem} .bar-visualization{height:50px} .btn-optimize{font-size:0.875rem;padding:0.75rem} .mode-option{padding:0.75rem} .mode-icon{width:36px;height:36px;font-size:1rem} } .hidden{display:none !important} @media (hover:none) and (pointer:coarse){.nav-button, .btn-optimize, .btn-secondary{min-height:44px;min-width:44px} input[type="number"], input[type="text"]{font-size:16px} }</style></head><body><header class="header"><div class="container"><div class="header-content"><div class="page-title"><div class="page-icon"><i class="fas fa-cogs"></i></div><div class="title-text"><h1>Custom Optimizer</h1><p>Specialized cutting optimization</p></div></div><a href="index.html" class="back-btn"><i class="fas fa-home"></i><span class="back-btn-text">Back to Home</span></a></div></div></header><div class="container main-content"><div class="content-grid"><div class="panel"><div class="panel-header"><h2 class="panel-title"><i class="fas fa-sliders-h"></i> Parameters </h2></div><div class="panel-content"><div class="material-length-notice"><i class="fas fa-info-circle"></i><strong>Material Length:</strong> Fixed at 6000 mm for FF-CA-01 optimization </div><form id="optimizerFormCustom"><div class="form-group"><label class="form-label"><i class="fas fa-tasks"></i> Mode </label><div class="mode-selector"><div class="mode-option active" data-mode="ff-ca-01"><div class="mode-icon"><i class="fas fa-ring"></i></div><div class="mode-info"><div class="mode-name">FF-CA-01</div><div class="mode-description">Ring cutting optimization with A/B pattern</div></div><i class="fas fa-check-circle" style="color: #10b981;"></i></div></div></div><div id="ff-ca01-params" class="ff-ca01-params"><div class="ff-ca01-title"><i class="fas fa-cube"></i> FF-CA-01 Parameters </div><div class="ff-ca01-image-container"><img src="assets/images/ff-ca-01.png" alt="FF-CA-01 Pattern" class="ff-ca01-image" id="ffCa01Image" onerror="this.style.display='none'; document.getElementById('ff-ca01-image-fallback').style.display='block';"><div id="ff-ca01-image-fallback" style="display: none; padding: 2rem; background-color: #f3f4f6; border-radius: 6px;"><i class="fas fa-image" style="font-size: 3rem; color: #d1d5db; margin-bottom: 1rem;"></i><p style="color: #6b7280;">FF-CA-01 pattern reference image</p></div><p class="ff-ca01-image-caption">Reference pattern for FF-CA-01 cutting optimization</p></div><div class="ff-ca01-table"><table><thead><tr><th></th><th class="bg-blue-50 text-blue-700">SR (mm)</th><th class="bg-green-50 text-green-700">BR (mm)</th></tr></thead><tbody><tr><td class="bg-gray-50 font-medium">A</td><td><input type="number" id="smallRingA" placeholder="0" min="0" step="1" value="0" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500"></td><td><input type="number" id="bigRingA" placeholder="0" min="0" step="1" value="0" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-green-500"></td></tr><tr><td class="bg-gray-50 font-medium">B</td><td><input type="number" id="smallRingB" placeholder="0" min="0" step="1" value="0" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-blue-500"></td><td><input type="number" id="bigRingB" placeholder="0" min="0" step="1" value="0" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-green-500"></td></tr></tbody></table></div><div class="form-group mt-4"><label for="multiplier" class="form-label"><i class="fas fa-copy"></i> Multiplier (Jumlah Set) </label><input type="number" id="multiplier" value="1" min="1" step="1" class="w-full"></div></div><div class="form-group"><label for="kerfWidthCustom" class="form-label"><i class="fas fa-cut"></i> Kerf / Blade Width (mm) </label><input type="number" id="kerfWidthCustom" value="0" min="0" step="1" class="w-full"></div><div class="form-group"><label for="algorithmCustom" class="form-label"><i class="fas fa-cogs"></i> Algorithm </label><select id="algorithmCustom" class="w-full"><option value="first-fit">First-Fit (Fast)</option><option value="best-fit">Best-Fit (Balanced)</option><option value="worst-fit">Worst-Fit (Experimental)</option></select></div><div class="action-buttons"><button type="submit" id="optimizeBtnCustom" class="btn-optimize"><i class="fas fa-bolt"></i><span id="optimizeTextCustom">Optimize</span><span id="optimizeSpinnerCustom" class="hidden spinner"></span></button></div></form><div id="errorCustom" class="alert alert-error hidden mt-4"></div></div></div><div class="panel"><div id="resultsContainerCustom" class="hidden"><div class="panel-header"><h2 class="panel-title"><i class="fas fa-chart-line"></i> Optimization Results </h2><div class="export-pdf-container"><button id="exportPdfBtnCustom" class="btn btn-secondary"><i class="fas fa-file-pdf"></i><span id="exportTextCustom">Export PDF</span><span id="exportSpinnerCustom" class="hidden spinner spinner-dark"></span></button></div></div><div class="panel-content"><div id="summaryStatsCustom" class="stats-grid"></div><div class="results-header"><h3 class="panel-title" style="font-size: 1rem;"><i class="fas fa-chart-bar"></i> Bar Layouts </h3><div class="nav-controls"><span id="barCounterCustom" class="text-sm text-gray-600">Bar 1 of 0</span><button id="prevBarBtnCustom" class="nav-button"><i class="fas fa-chevron-left"></i></button><button id="nextBarBtnCustom" class="nav-button"><i class="fas fa-chevron-right"></i></button></div></div><div id="barDetailsCustom" class="bar-details"><div class="scroll-indicator"><i class="fas fa-arrows-left-right"></i> Scroll horizontally to see full bar </div></div></div></div><div id="emptyResultsCustom" class="empty-state"><div class="empty-icon"><i class="fas fa-calculator"></i></div><h3 class="text-lg font-semibold text-gray-700 mb-2">Results will be displayed here</h3><p class="text-gray-500 max-w-md"> Configure the parameters and click "Optimize" to see optimization results. </p></div></div></div></div><footer class="footer"><div class="container"><p>Engineered by Eghy Al Vandi</p></div></footer><script> // Initialize custom optimizer when page loads document.addEventListener('DOMContentLoaded', function() { console.log("Custom Optimizer page loaded"); // Initialize custom optimizer from script.js if (typeof initCustomOptimizer === 'function') { console.log("Initializing custom optimizer..."); initCustomOptimizer(); } else { console.error('initCustomOptimizer not found in script.js'); // Try to load script.js dynamically if not loaded const scriptCheck = setInterval(function() { if (typeof initCustomOptimizer === 'function') { clearInterval(scriptCheck); initCustomOptimizer(); } }, 100); // Fallback after 5 seconds setTimeout(function() { if (typeof initCustomOptimizer !== 'function') { console.error('Failed to load custom optimizer functions'); alert('Error: Custom optimizer functions not loaded. Please refresh the page.'); } }, 5000); } // Add mobile-specific optimizations setupMobileOptimizations(); // Ensure text colors are properly set for mobile setupMobileTextColors(); // Reset all values to 0 on page load/refresh resetAllValuesToZero(); // Setup input validation setupInputValidation(); }); // Function to validate FF-CA-01 parameters according to revised rules function validateFFCA01Params(smallRingA, bigRingA, smallRingB, bigRingB) { // Check if values are negative if (smallRingA < 0 || bigRingA < 0 || smallRingB < 0 || bigRingB < 0) { return { valid: false, message: 'Error: Nilai tidak boleh negatif. Harap masukkan nilai 0 atau lebih besar.' }; } const isSRAFilled = smallRingA > 0; const isSRBFilled = smallRingB > 0; const isBRAFilled = bigRingA > 0; const isBRBFilled = bigRingB > 0; // Check if Small Rings are both filled or both empty if (isSRAFilled !== isSRBFilled) { return { valid: false, message: 'Error: Jika mengisi Small Ring (SR), maka SR-A dan SR-B harus diisi keduanya.' }; } // Check if Big Rings are both filled or both empty if (isBRAFilled !== isBRBFilled) { return { valid: false, message: 'Error: Jika mengisi Big Ring (BR), maka BR-A dan BR-B harus diisi keduanya.' }; } // Check valid combinations according to revision // 1. Small Ring-A (tidak terisi) & Small Ring-B (tidak terisi) ; Big Ring-A (terisi) & Big Ring-B (terisi) -> Valid // 2. Small Ring-A (terisi) & Small Ring-B (terisi) ; Big Ring-A (tidak terisi) & Big Ring-B (tidak terisi) -> Valid // 3. Small Ring-A (terisi) & Small Ring-B (terisi) ; Big Ring-A (terisi) & Big Ring-B (terisi) -> Valid const isSREmpty = !isSRAFilled && !isSRBFilled; const isBREmpty = !isBRAFilled && !isBRBFilled; const isSRComplete = isSRAFilled && isSRBFilled; const isBRComplete = isBRAFilled && isBRBFilled; // Valid combinations const isValid1 = isSREmpty && isBRComplete; // SR empty, BR complete const isValid2 = isSRComplete && isBREmpty; // SR complete, BR empty const isValid3 = isSRComplete && isBRComplete; // Both complete if (!isValid1 && !isValid2 && !isValid3) { return { valid: false, message: 'Error: Konfigurasi tidak valid. Pilihan yang valid: 1) SR-A dan SR-B tidak terisi, BR-A dan BR-B terisi, 2) SR-A dan SR-B terisi, BR-A dan BR-B tidak terisi, 3) Semua terisi (SR-A, SR-B, BR-A, BR-B).' }; } return { valid: true, message: '' }; } // Function to get FF-CA-01 parameters dengan validasi yang benar function getFFCA01Params() { const smallRingA = parseFloat(document.getElementById('smallRingA').value) || 0; const bigRingA = parseFloat(document.getElementById('bigRingA').value) || 0; const smallRingB = parseFloat(document.getElementById('smallRingB').value) || 0; const bigRingB = parseFloat(document.getElementById('bigRingB').value) || 0; const multiplier = parseInt(document.getElementById('multiplier').value) || 1; const kerfWidth = parseFloat(document.getElementById('kerfWidthCustom').value) || 0; // Validate parameters const validation = validateFFCA01Params(smallRingA, bigRingA, smallRingB, bigRingB); if (!validation.valid) { document.getElementById('errorCustom').textContent = validation.message; document.getElementById('errorCustom').classList.remove('hidden'); return null; } // If valid, hide error document.getElementById('errorCustom').classList.add('hidden'); return { smallRingA: Math.round(smallRingA), bigRingA: Math.round(bigRingA), smallRingB: Math.round(smallRingB), bigRingB: Math.round(bigRingB), multiplier: Math.round(multiplier), kerfWidth: Math.round(kerfWidth) }; } // Reset all input values to 0 on page load/refresh function resetAllValuesToZero() { console.log("Resetting all values to 0..."); // Get all input elements const smallRingAInput = document.getElementById('smallRingA'); const bigRingAInput = document.getElementById('bigRingA'); const smallRingBInput = document.getElementById('smallRingB'); const bigRingBInput = document.getElementById('bigRingB'); const kerfWidthInput = document.getElementById('kerfWidthCustom'); const multiplierInput = document.getElementById('multiplier'); // Reset values to 0 if (smallRingAInput) smallRingAInput.value = 0; if (bigRingAInput) bigRingAInput.value = 0; if (smallRingBInput) smallRingBInput.value = 0; if (bigRingBInput) bigRingBInput.value = 0; if (kerfWidthInput) kerfWidthInput.value = 0; if (multiplierInput) multiplierInput.value = 1; // Also reset any form data that might be stored if (typeof localStorage !== 'undefined') { localStorage.removeItem('customOptimizerFormData'); } // Force the form to reset const form = document.getElementById('optimizerFormCustom'); if (form) form.reset(); // Hide error if exists const errorElement = document.getElementById('errorCustom'); if (errorElement) errorElement.classList.add('hidden'); } // Initialize with zero values function initializeWithZeroValues() { console.log("Initializing with zero values..."); resetAllValuesToZero(); } // Call initialization setTimeout(initializeWithZeroValues, 100); // Setup input validation function setupInputValidation() { // Add event listeners for input changes const inputs = [ 'smallRingA', 'bigRingA', 'smallRingB', 'bigRingB', 'multiplier', 'kerfWidthCustom' ]; inputs.forEach(inputId => { const input = document.getElementById(inputId); if (input) { input.addEventListener('input', function() { // Hide error when user starts typing const errorElement = document.getElementById('errorCustom'); if (errorElement) errorElement.classList.add('hidden'); // Validate for negative values const value = parseFloat(this.value) || 0; if (value < 0) this.value = 0; // Auto-suggestion for pairs suggestPairCompletion(this.id, value); }); // Validate on blur input.addEventListener('blur', function() { const value = parseFloat(this.value) || 0; if (value < 0) this.value = 0; }); } }); // Add event listener for form submit const form = document.getElementById('optimizerFormCustom'); if (form) { form.addEventListener('submit', function(e) { e.preventDefault(); // Validate before submit const params = getFFCA01Params(); if (params === null) return false; // If valid, proceed with optimization if (typeof runCustomOptimization === 'function') { runCustomOptimization(params); } else { console.error('runCustomOptimization function not found'); alert('Error: Optimization function not loaded. Please refresh the page.'); } return false; }); } } // Function to suggest pair completion function suggestPairCompletion(inputId, value) { if (value > 0) { let suggestion = ''; if (inputId === 'smallRingA' || inputId === 'smallRingB') { suggestion = 'Saran: Untuk konfigurasi yang valid, pastikan kedua Small Ring (SR-A dan SR-B) diisi atau dikosongkan bersama.'; } else if (inputId === 'bigRingA' || inputId === 'bigRingB') { suggestion = 'Saran: Untuk konfigurasi yang valid, pastikan kedua Big Ring (BR-A dan BR-B) diisi atau dikosongkan bersama.'; } if (suggestion) console.log(suggestion); } } // Preload image window.addEventListener('load', function() { const img = new Image(); img.src = 'assets/images/ff-ca-01.png'; img.onload = function() { console.log('FF-CA-01 image loaded successfully'); }; img.onerror = function() { console.warn('FF-CA-01 image not found, using fallback'); }; // Double-check values after page fully loads setTimeout(resetAllValuesToZero, 500); }); // Setup mobile-specific optimizations function setupMobileOptimizations() { // Improve touch target sizes for mobile if ('ontouchstart' in window) { const touchElements = document.querySelectorAll('.nav-button, .btn-optimize, .btn-secondary, .mode-option'); touchElements.forEach(el => { el.style.minHeight = '44px'; el.style.minWidth = '44px'; }); // Ensure inputs are easily tappable const inputs = document.querySelectorAll('input[type="number"], input[type="text"], select'); inputs.forEach(input => { input.style.fontSize = '16px'; // Prevents iOS zoom on focus }); } } // Function to ensure text colors are properly set for mobile function setupMobileTextColors() { if (window.innerWidth <= 768) { const textElements = document.querySelectorAll('.panel-title, .form-label, .ff-ca01-title, .bar-info, .stat-value, .stat-label, .bar-item-row, .mode-name, .ff-ca01-table th'); textElements.forEach(el => { if (getComputedStyle(el).color === 'rgb(107, 114, 128)' || getComputedStyle(el).color === 'rgb(156, 163, 175)' || getComputedStyle(el).color === 'rgb(75, 85, 99)') { el.style.color = '#1a1a1a'; } }); } } // Re-check on resize window.addEventListener('resize', setupMobileTextColors); // Add event listener for page visibility change document.addEventListener('visibilitychange', function() { if (!document.hidden) { setTimeout(resetAllValuesToZero, 100); } }); // Also reset on pageshow event (for Safari back/forward cache) window.addEventListener('pageshow', function(event) { if (event.persisted) { setTimeout(resetAllValuesToZero, 100); } }); // Function to run optimization (akan dipanggil dari script.js) function runCustomOptimization(params) { console.log("Running optimization with params:", params); if (typeof window.runFFCA01Optimization === 'function') { window.runFFCA01Optimization(params); } else { console.error('runFFCA01Optimization function not found'); alert('Optimization function not available. Please check script.js'); } } </script></body></html>